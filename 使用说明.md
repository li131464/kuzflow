# åŒ–å·¥å‚è®¢å•å¤„ç†ç³»ç»Ÿ - ä½¿ç”¨è¯´æ˜

## ğŸ¯ ç³»ç»Ÿç®€ä»‹

æœ¬ç³»ç»Ÿé€šè¿‡OCRæ–‡å­—è¯†åˆ«å’Œå¤§æ¨¡å‹ä¿¡æ¯æå–æŠ€æœ¯ï¼Œè‡ªåŠ¨å¤„ç†åŒ–å·¥å‚è®¢å•å›¾ç‰‡ï¼Œæå–å…³é”®ä¿¡æ¯ï¼š
- ç”²æ–¹å…¬å¸åç§°
- è´­ä¹°ç‰©å“åç§°  
- è´­ä¹°ç‰©å“æ•°é‡ï¼ˆå«å•ä½ï¼‰
- ä¸‹è®¢å•æ—¥æœŸ

## âš¡ å¿«é€Ÿå¼€å§‹

### ç¬¬1æ­¥ï¼šç¯å¢ƒè®¾ç½®
```bash
# åŒå‡»è¿è¡Œç¯å¢ƒè®¾ç½®è„šæœ¬ï¼ˆä»…éœ€è¿è¡Œä¸€æ¬¡ï¼‰
setup_environments.bat
```

### ç¬¬2æ­¥ï¼šé€‰æ‹©å¤„ç†æ–¹å¼

#### ğŸ”¸ å•å›¾ç‰‡å¤„ç†
```bash
# åŒå‡»è¿è¡Œå•å›¾ç‰‡å·¥ä½œæµç¨‹
run_complete_workflow.bat
```

#### ğŸ”¸ æ‰¹é‡å¤„ç†ï¼ˆæ¨èï¼‰
```bash
# åŒå‡»è¿è¡Œæ‰¹é‡å¤„ç†å·¥ä½œæµç¨‹
run_batch_workflow.bat
```

## ğŸ“‹ è¯¦ç»†ä½¿ç”¨è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Windows 10/11
- Miniconda/Anaconda
- NVIDIA GPUï¼ˆæ¨èï¼ŒCPUä¹Ÿå¯è¿è¡Œï¼‰
- 8GB+ RAM

### æ–‡ä»¶ç»“æ„
```
kuzflow/
â”œâ”€â”€ setup_environments.bat          # ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ run_complete_workflow.bat       # å•å›¾ç‰‡å·¥ä½œæµç¨‹
â”œâ”€â”€ run_batch_workflow.bat          # æ‰¹é‡å¤„ç†å·¥ä½œæµç¨‹
â”œâ”€â”€ test_ocr_compatible.py          # OCRæµ‹è¯•è„šæœ¬
â”œâ”€â”€ test_deepseek_compatible.py     # DeepSeekæµ‹è¯•è„šæœ¬
â”œâ”€â”€ batch_ocr_compatible.py         # æ‰¹é‡OCRå¤„ç†è„šæœ¬
â”œâ”€â”€ batch_deepseek_compatible.py    # æ‰¹é‡AIå¤„ç†è„šæœ¬
â”œâ”€â”€ show_final_results.py           # å•å›¾ç‰‡ç»“æœæ˜¾ç¤º
â”œâ”€â”€ show_batch_results.py           # æ‰¹é‡ç»“æœæ˜¾ç¤º
â”œâ”€â”€ OCR/
â”‚   â””â”€â”€ image/                      # å›¾ç‰‡å­˜æ”¾ç›®å½•
â”‚       â””â”€â”€ *.png/*.jpg/*.jpeg      # æ”¯æŒå¤šç§æ ¼å¼å›¾ç‰‡
â”œâ”€â”€ LLM/
â”‚   â””â”€â”€ DeepSeek-R1-Distill-Qwen-1.5B/  # AIæ¨¡å‹
â””â”€â”€ temp_results/                   # å¤„ç†ç»“æœç›®å½•
    â”œâ”€â”€ single/                     # å•å›¾ç‰‡å¤„ç†ç»“æœ
    â””â”€â”€ batch/                      # æ‰¹é‡å¤„ç†ç»“æœ
```

## ğŸ”§ åˆ†æ­¥æ“ä½œæŒ‡å—

### æ–¹æ³•1ï¼šä¸€é”®è¿è¡Œï¼ˆæ¨èï¼‰

1. **ç¯å¢ƒè®¾ç½®**ï¼ˆä»…éœ€è¿è¡Œä¸€æ¬¡ï¼‰
   ```bash
   setup_environments.bat
   ```
   
2. **å¤„ç†è®¢å•å›¾ç‰‡**
   ```bash
   run_complete_workflow.bat
   ```

### æ–¹æ³•2ï¼šåˆ†æ­¥è¿è¡Œ

1. **OCRè¯†åˆ«**
   ```bash
   conda activate ocr_env
   python test_ocr_compatible.py
   ```

2. **AIä¿¡æ¯æå–**
   ```bash
   conda activate deepseek_env  
   python test_deepseek_compatible.py
   ```

3. **æŸ¥çœ‹ç»“æœ**
   ```bash
   python show_final_results.py
   ```

## ğŸ“Š è¾“å‡ºç»“æœ

### ğŸ”¸ å•å›¾ç‰‡å¤„ç†ç»“æœ
å¤„ç†æˆåŠŸåä¼šç”Ÿæˆï¼š
1. **temp_results/ocr_result.json** - è¯¦ç»†OCRç»“æœ
2. **temp_results/ocr_text.txt** - çº¯æ–‡æœ¬è¯†åˆ«ç»“æœ
3. **temp_results/final_result.json** - æœ€ç»ˆæå–ç»“æœ  
4. **temp_results/visualization.jpg** - å¯è§†åŒ–æ ‡æ³¨å›¾ç‰‡

### ğŸ”¸ æ‰¹é‡å¤„ç†ç»“æœ
æ‰¹é‡å¤„ç†ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š
```
temp_results/batch/
â”œâ”€â”€ batch_summary.json              # OCRå¤„ç†æ±‡æ€»ç»Ÿè®¡
â”œâ”€â”€ batch_ai_summary.json           # AIæå–æ±‡æ€»ç»Ÿè®¡
â”œâ”€â”€ [å›¾ç‰‡å1]/
â”‚   â”œâ”€â”€ ocr_result.json             # OCRè¯¦ç»†ç»“æœ
â”‚   â”œâ”€â”€ ocr_text.txt                # çº¯æ–‡æœ¬ç»“æœ
â”‚   â”œâ”€â”€ ai_result.json              # AIæå–ç»“æœ
â”‚   â””â”€â”€ visualization.jpg           # å¯è§†åŒ–å›¾ç‰‡
â”œâ”€â”€ [å›¾ç‰‡å2]/
â”‚   â””â”€â”€ ...
â””â”€â”€ [å›¾ç‰‡åN]/
    â””â”€â”€ ...
```

### ç»“æœç¤ºä¾‹ï¼š
```json
{
  "success": true,
  "ocr_info": {
    "text_lines_count": 12,
    "confidence_avg": 0.95,
    "raw_text": "XXåŒ–å·¥è´¸æ˜“å…¬å¸\nè´­ä¹°ç‰©å“\næ•°é‡: 500æ–¤\n..."
  },
  "ai_extraction": {
    "company_name": "XXåŒ–å·¥è´¸æ˜“å…¬å¸",
    "product_name": "åŒ–å·¥åŸæ–™",
    "product_quantity": "500æ–¤", 
    "order_date": "2024å¹´7æœˆ1æ—¥"
  }
}
```

## ğŸ”„ å¤„ç†è®¢å•å›¾ç‰‡

### ğŸ”¸ å•å›¾ç‰‡å¤„ç†
1. **æ›¿æ¢å›¾ç‰‡**
   - å°†è®¢å•å›¾ç‰‡ä¿å­˜ä¸º `OCR/image/ç”ŸæˆåŒ–å·¥å‚è®¢å•å›¾ç‰‡.png`

2. **è¿è¡Œå¤„ç†**
   ```bash
   run_complete_workflow.bat
   ```

### ğŸ”¸ æ‰¹é‡å¤„ç†ï¼ˆæ¨èï¼‰
1. **å‡†å¤‡å›¾ç‰‡**
   - å°†æ‰€æœ‰è®¢å•å›¾ç‰‡æ”¾å…¥ `OCR/image/` æ–‡ä»¶å¤¹
   - æ”¯æŒæ ¼å¼ï¼šPNG, JPG, JPEG, BMP, TIFF, TIF
   - å¯åŒæ—¶å¤„ç†å¤šå¼ ä¸åŒæ ¼å¼çš„å›¾ç‰‡

2. **è¿è¡Œæ‰¹é‡å¤„ç†**
   ```bash
   run_batch_workflow.bat
   ```

3. **æŸ¥çœ‹æ‰¹é‡ç»“æœ**
   - è‡ªåŠ¨æ˜¾ç¤ºæ‰€æœ‰å›¾ç‰‡çš„å¤„ç†ç»“æœ
   - æä¾›æ•´ä½“ç»Ÿè®¡å’Œä¸ªåˆ«è¯¦æƒ…

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: ç¯å¢ƒè®¾ç½®å¤±è´¥
**è§£å†³æ–¹æ¡ˆï¼š**
- ç¡®ä¿å·²å®‰è£…Miniconda/Anaconda
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œ

### Q2: OCRè¯†åˆ«ç²¾åº¦ä½
**å¯èƒ½åŸå› ï¼š**
- å›¾ç‰‡è´¨é‡ä¸ä½³
- æ–‡å­—æ¨¡ç³Šæˆ–å€¾æ–œ
- å¤æ‚èƒŒæ™¯å¹²æ‰°

**æ”¹è¿›å»ºè®®ï¼š**
- ä½¿ç”¨é«˜åˆ†è¾¨ç‡å›¾ç‰‡
- ç¡®ä¿æ–‡å­—æ¸…æ™°å¯è§
- å›¾ç‰‡è¾ƒæ­£ã€å»å™ªå¤„ç†

### Q3: AIæå–ä¿¡æ¯ä¸å‡†ç¡®
**å¯èƒ½åŸå› ï¼š**
- OCRè¯†åˆ«é”™è¯¯
- è®¢å•æ ¼å¼ä¸æ ‡å‡†
- æ¨¡å‹ç†è§£åå·®

**æ”¹è¿›æ–¹æ¡ˆï¼š**
- æ£€æŸ¥OCRè¯†åˆ«ç»“æœ
- ä¼˜åŒ–æç¤ºè¯æ¨¡æ¿
- å¢åŠ è®­ç»ƒæ•°æ®

### Q4: æ˜¾å­˜ä¸è¶³
**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ä½¿ç”¨CPUè¿è¡ŒDeepSeek
conda activate deepseek_env
set CUDA_VISIBLE_DEVICES=-1
python test_deepseek_compatible.py
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### æå‡è¯†åˆ«é€Ÿåº¦ï¼š
1. **ä½¿ç”¨GPUåŠ é€Ÿ**
   - ç¡®ä¿å®‰è£…CUDA
   - ä½¿ç”¨GPUç‰ˆæœ¬çš„ä¾èµ–åŒ…

2. **æ‰¹é‡å¤„ç†**
   - ä¿®æ”¹è„šæœ¬æ”¯æŒå¤šå›¾ç‰‡å¤„ç†
   - ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†

### æå‡è¯†åˆ«ç²¾åº¦ï¼š
1. **å›¾ç‰‡é¢„å¤„ç†**
   - å»å™ªã€é”åŒ–
   - è§’åº¦æ ¡æ­£
   - å¯¹æ¯”åº¦å¢å¼º

2. **æ¨¡å‹ä¼˜åŒ–**
   - ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹
   - é’ˆå¯¹ç‰¹å®šåœºæ™¯å¾®è°ƒ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©ï¼š
1. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
2. æ£€æŸ¥ç¯å¢ƒé…ç½®
3. å‚è€ƒé¡¹ç›®æ–‡æ¡£

### å¸¸ç”¨å‘½ä»¤ï¼š
```bash
# æŸ¥çœ‹condaç¯å¢ƒ
conda info --envs

# æ¿€æ´»ç¯å¢ƒ
conda activate ocr_env
conda activate deepseek_env

# æŸ¥çœ‹ä¾èµ–åŒ…
pip list

# é‡æ–°å®‰è£…ç¯å¢ƒ
conda remove -n ocr_env --all
conda remove -n deepseek_env --all
setup_environments.bat
```

## ğŸ“ˆ ç³»ç»Ÿå‡çº§

### å‡çº§OCRæ¨¡å‹ï¼š
```bash
conda activate ocr_env
pip install --upgrade paddleocr
```

### å‡çº§AIæ¨¡å‹ï¼š
```bash
conda activate deepseek_env
pip install --upgrade transformers
```

---

## ğŸ‰ å®Œæˆï¼

æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å°±å¯ä»¥æˆåŠŸä½¿ç”¨åŒ–å·¥å‚è®¢å•å¤„ç†ç³»ç»Ÿäº†ï¼

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. âœ… ç¯å¢ƒæ˜¯å¦æ­£ç¡®è®¾ç½®
2. âœ… æ¨¡å‹æ˜¯å¦æˆåŠŸä¸‹è½½  
3. âœ… å›¾ç‰‡è·¯å¾„æ˜¯å¦æ­£ç¡®
4. âœ… ç³»ç»Ÿæƒé™æ˜¯å¦è¶³å¤Ÿ

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€ 